<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Pendik Ä°SM Denetim</title>
<link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans:wght@400;600&display=swap" rel="stylesheet">
<style>
  :root{--bg:#f0ede8;--surface:#fff;--border:#d4cfc8;--text:#1a1814;--accent:#c0392b;--accent2:#2c3e50;--r:4px;--shadow:0 1px 3px rgba(0,0,0,.08)}
  body{font-family:'IBM Plex Sans',sans-serif;background:var(--bg);margin:0;padding:0}
  header{background:var(--accent2);color:#fff;padding:15px;display:flex;justify-content:space-between;align-items:center}
  #app-screen{padding:20px;max-width:700px;margin:0 auto}
  .card{background:var(--surface);border:1px solid var(--border);border-radius:var(--r);padding:20px;box-shadow:var(--shadow);margin-bottom:15px}
  input,textarea{width:100%;border:1px solid var(--border);border-radius:var(--r);padding:10px;margin-top:5px;font-family:inherit}
  textarea{min-height:150px}
  .btn-save{width:100%;padding:15px;background:var(--accent);color:#fff;border:none;border-radius:var(--r);font-weight:600;cursor:pointer}
  .status{margin-top:10px;padding:10px;text-align:center;border-radius:var(--r);display:none}
  .status.ok{background:#eafaf1;color:#27ae60;display:block}
  .status.err{background:#fdf0ef;color:#c0392b;display:block}
  .th{text-align:center;border-bottom:1px solid var(--border);margin-bottom:15px;padding-bottom:10px}
</style>
</head>
<body>

<header>
  <div><strong>Pendik Ä°SM Denetim</strong></div>
  <div style="font-size:12px">T.C. SaÄŸlÄ±k BakanlÄ±ÄŸÄ±</div>
</header>

<div id="app-screen">
  <div class="card">
    <div class="th">
      <div>T.C. PENDÄ°K KAYMAKAMLIÄI</div>
      <div>Ä°lÃ§e SaÄŸlÄ±k MÃ¼dÃ¼rlÃ¼ÄŸÃ¼</div>
      <div style="font-weight:600;margin-top:10px">DENETÄ°M TUTANAÄI</div>
    </div>
    <div style="display:grid;grid-template-columns:1fr 1fr;gap:10px">
      <div><label>Tarih</label><input type="date" id="f-tarih"></div>
      <div><label>Denetlenen</label><input type="text" id="f-denetlenen" placeholder="Ad Soyad / Kurum"></div>
    </div>
    <div style="margin-top:10px"><label>Konu</label><input type="text" id="f-konu"></div>
  </div>

  <div class="card">
    <label>Ä°mza Sahipleri</label>
    <input type="text" id="f-baskani" placeholder="Ekip BaÅŸkanÄ± Ad Soyad">
    <div id="denetci-list" style="margin-top:10px">
        <input type="text" placeholder="DenetÃ§i 1">
        <input type="text" placeholder="DenetÃ§i 2">
    </div>
  </div>

  <div class="card">
    <label>Denetim NotlarÄ±</label>
    <textarea id="f-notlar"></textarea>
  </div>

  <button class="btn-save" onclick="kaydet()">ğŸ“¥ TutanaÄŸÄ± Ä°ndir (.docx)</button>
  <div class="status" id="status"></div>
</div>

<script>
// NOT: Logo hatasÄ± almamak iÃ§in buraya geÃ§erli bir Base64 koydum. 
// Kendi logonuzu koyarken tÃ¼m karakterleri eksiksiz kopyaladÄ±ÄŸÄ±nÄ±zdan emin olun.
const LOGO_B64 = 'iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVR42mP8/5+hHgAHggJ/PchI7wAAAABJRU5ErkJggg=='; 

function xe(s){return(s||'').replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;');}

function row(metin, bold, center, size) {
  const jc = center ? '<w:jc w:val="center"/>' : '';
  const b = bold ? '<w:b/><w:bCs/>' : '';
  return `<w:p><w:pPr>${jc}</w:pPr><w:r><w:rPr>${b}<w:sz w:val="${size}"/><w:szCs w:val="${size}"/></w:rPr><w:t>${xe(metin)}</w:t></w:r></w:p>`;
}

async function kaydet() {
  const st = document.getElementById('status');
  st.style.display = 'none';
  
  try {
    // JSZip kÃ¼tÃ¼phanesini yÃ¼kle
    if(!window.JSZip) {
        const s = document.createElement('script');
        s.src = 'https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js';
        document.head.appendChild(s);
        await new Promise(r => s.onload = r);
    }

    const tarih = document.getElementById('f-tarih').value;
    const konu = document.getElementById('f-konu').value;
    const baskani = document.getElementById('f-baskani').value;
    const denetlenen = document.getElementById('f-denetlenen').value;
    const notlar = document.getElementById('f-notlar').value;

    const docXml = `<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
    <w:document xmlns:w="http://schemas.openxmlformats.org/wordprocessingml/2006/main" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships" xmlns:wp="http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing" xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" xmlns:pic="http://schemas.openxmlformats.org/drawingml/2006/picture">
      <w:body>
        <w:p><w:pPr><w:jc w:val="left"/></w:pPr><w:r><w:drawing><wp:inline><wp:extent cx="1000000" cy="1000000"/><wp:docPr id="1" name="Logo"/><a:graphic><a:graphicData uri="http://schemas.openxmlformats.org/drawingml/2006/picture"><pic:pic><pic:nvPicPr><pic:cNvPr id="1" name="Logo"/><pic:cNvPicPr/></pic:nvPicPr><pic:blipFill><a:blip r:embed="rId2"/></pic:blipFill><pic:spPr><a:xfrm><a:off x="0" y="0"/><a:ext cx="1000000" cy="1000000"/></a:xfrm><a:prstGeom prst="rect"/></pic:spPr></pic:pic></a:graphicData></a:graphic></wp:inline></w:drawing></w:r></w:p>
        ${row('T.C.', true, true, 24)}
        ${row('PENDÄ°K KAYMAKAMLIÄI', true, true, 24)}
        ${row('Ä°lÃ§e SaÄŸlÄ±k MÃ¼dÃ¼rlÃ¼ÄŸÃ¼', true, true, 24)}
        ${row('DENETÄ°M TUTANAÄI', true, true, 28)}
        <w:p><w:pPr><w:tabs><w:tab w:val="right" w:pos="9070"/></w:tabs></w:pPr><w:r><w:rPr><w:b/></w:rPr><w:t>Konu: ${xe(konu)}</w:t></w:r><w:r><w:tab/></w:r><w:r><w:rPr><w:b/></w:rPr><w:t>Tarih: ${xe(tarih)}</w:t></w:r></w:p>
        ${row(notlar, false, false, 22)}
        <w:sectPr>
          <w:pgSz w:w="11906" w:h="16838"/>
          <w:pgMar w:top="1440" w:right="1440" w:bottom="1440" w:left="1440"/>
          <w:pgBorders w:offsetFrom="page">
            <w:top w:val="single" w:sz="12" w:space="24" w:color="000000"/>
            <w:left w:val="single" w:sz="12" w:space="24" w:color="000000"/>
            <w:bottom w:val="single" w:sz="12" w:space="24" w:color="000000"/>
            <w:right w:val="single" w:sz="12" w:space="24" w:color="000000"/>
          </w:pgBorders>
        </w:sectPr>
      </w:body>
    </w:document>`;

    const zip = new JSZip();
    zip.file('word/document.xml', docXml);
    zip.file('word/_rels/document.xml.rels', `<?xml version="1.0" encoding="UTF-8"?><Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships"><Relationship Id="rId2" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/image" Target="media/logo.png"/></Relationships>`);
    zip.file('word/media/logo.png', Uint8Array.from(atob(LOGO_B64), c => c.charCodeAt(0)));
    zip.file('[Content_Types].xml', `<?xml version="1.0" encoding="UTF-8"?><Types xmlns="http://schemas.openxmlformats.org/package/2006/content-types"><Default Extension="rels" ContentType="application/vnd.openxmlformats-package.relationships+xml"/><Default Extension="xml" ContentType="application/xml"/><Default Extension="png" ContentType="image/png"/><Override PartName="/word/document.xml" ContentType="application/vnd.openxmlformats-officedocument.wordprocessingml.document.main+xml"/></Types>`);
    zip.file('_rels/.rels', `<?xml version="1.0" encoding="UTF-8"?><Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships"><Relationship Id="rId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument" Target="word/document.xml"/></Relationships>`);

    const blob = await zip.generateAsync({type:'blob'});
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a'); a.href = url; a.download = 'Tutanak.docx'; a.click();
    st.className = 'status ok'; st.textContent = 'âœ… Dosya indirildi!';
  } catch(e) {
    st.className = 'status err'; st.textContent = 'âŒ Hata: ' + e.message;
  }
}
</script>
</body>
</html>
